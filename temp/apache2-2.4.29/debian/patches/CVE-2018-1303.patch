Description: fix mod_cache_socache DoS
Origin: upstream, https://svn.apache.org/viewvc?view=revision&revision=1824475

Index: apache2-2.4.29/modules/cache/mod_cache_socache.c
===================================================================
--- apache2-2.4.29.orig/modules/cache/mod_cache_socache.c	2017-06-29 07:31:20.000000000 -0400
+++ apache2-2.4.29/modules/cache/mod_cache_socache.c	2018-04-18 09:15:39.675307037 -0400
@@ -213,7 +213,8 @@ static apr_status_t read_table(cache_han
                         "Premature end of cache headers.");
                 return APR_EGENERAL;
             }
-            while (apr_isspace(buffer[colon])) {
+            /* Do not go past the \r from above as apr_isspace('\r') is true */
+            while (apr_isspace(buffer[colon]) && (colon < *slider)) {
                 colon++;
             }
             apr_table_addn(table, apr_pstrndup(r->pool, (const char *) buffer
